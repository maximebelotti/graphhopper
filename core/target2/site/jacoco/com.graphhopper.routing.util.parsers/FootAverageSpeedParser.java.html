<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="es"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>FootAverageSpeedParser.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">GraphHopper Core</a> &gt; <a href="index.source.html" class="el_package">com.graphhopper.routing.util.parsers</a> &gt; <span class="el_source">FootAverageSpeedParser.java</span></div><h1>FootAverageSpeedParser.java</h1><pre class="source lang-java linenums">package com.graphhopper.routing.util.parsers;

import com.graphhopper.reader.ReaderWay;
import com.graphhopper.routing.ev.*;
import com.graphhopper.routing.util.FerrySpeedCalculator;

import java.util.HashMap;
import java.util.Map;

import static com.graphhopper.routing.ev.RouteNetwork.*;
import static com.graphhopper.routing.util.PriorityCode.UNCHANGED;

public class FootAverageSpeedParser extends AbstractAverageSpeedParser implements TagParser {
    static final int SLOW_SPEED = 2;
    static final int MEAN_SPEED = 5;
<span class="fc" id="L16">    protected Map&lt;RouteNetwork, Integer&gt; routeMap = new HashMap&lt;&gt;();</span>

    public FootAverageSpeedParser(EncodedValueLookup lookup) {
<span class="fc" id="L19">        this(lookup.getDecimalEncodedValue(VehicleSpeed.key(&quot;foot&quot;)),</span>
<span class="fc" id="L20">                lookup.getDecimalEncodedValue(FerrySpeed.KEY));</span>
<span class="fc" id="L21">    }</span>

    public FootAverageSpeedParser(DecimalEncodedValue speedEnc, DecimalEncodedValue ferrySpeedEnc) {
<span class="fc" id="L24">        super(speedEnc, ferrySpeedEnc);</span>

<span class="fc" id="L26">        routeMap.put(INTERNATIONAL, UNCHANGED.getValue());</span>
<span class="fc" id="L27">        routeMap.put(NATIONAL, UNCHANGED.getValue());</span>
<span class="fc" id="L28">        routeMap.put(REGIONAL, UNCHANGED.getValue());</span>
<span class="fc" id="L29">        routeMap.put(LOCAL, UNCHANGED.getValue());</span>
<span class="fc" id="L30">    }</span>

    @Override
    public void handleWayTags(int edgeId, EdgeIntAccess edgeIntAccess, ReaderWay way) {
<span class="fc" id="L34">        String highwayValue = way.getTag(&quot;highway&quot;);</span>
<span class="fc bfc" id="L35" title="All 2 branches covered.">        if (highwayValue == null) {</span>
<span class="fc bfc" id="L36" title="All 2 branches covered.">            if (FerrySpeedCalculator.isFerry(way)) {</span>
<span class="fc" id="L37">                double ferrySpeed = FerrySpeedCalculator.minmax(ferrySpeedEnc.getDecimal(false, edgeId, edgeIntAccess), avgSpeedEnc);</span>
<span class="fc" id="L38">                setSpeed(false, edgeId, edgeIntAccess, ferrySpeed);</span>
<span class="pc bpc" id="L39" title="1 of 2 branches missed.">                if (avgSpeedEnc.isStoreTwoDirections())</span>
<span class="nc" id="L40">                    setSpeed(true, edgeId, edgeIntAccess, ferrySpeed);</span>
            }
<span class="fc bfc" id="L42" title="All 4 branches covered.">            if (!way.hasTag(&quot;railway&quot;, &quot;platform&quot;) &amp;&amp; !way.hasTag(&quot;man_made&quot;, &quot;pier&quot;))</span>
<span class="fc" id="L43">                return;</span>
        }

<span class="fc" id="L46">        String sacScale = way.getTag(&quot;sac_scale&quot;);</span>
<span class="fc bfc" id="L47" title="All 2 branches covered.">        if (sacScale != null) {</span>
<span class="fc bfc" id="L48" title="All 2 branches covered.">            setSpeed(false, edgeId, edgeIntAccess, &quot;hiking&quot;.equals(sacScale) ? MEAN_SPEED : SLOW_SPEED);</span>
<span class="pc bpc" id="L49" title="1 of 2 branches missed.">            if (avgSpeedEnc.isStoreTwoDirections())</span>
<span class="nc bnc" id="L50" title="All 2 branches missed.">                setSpeed(true, edgeId, edgeIntAccess, &quot;hiking&quot;.equals(sacScale) ? MEAN_SPEED : SLOW_SPEED);</span>
        } else {
<span class="fc bfc" id="L52" title="All 2 branches covered.">            setSpeed(false, edgeId, edgeIntAccess, way.hasTag(&quot;highway&quot;, &quot;steps&quot;) ? MEAN_SPEED - 2 : MEAN_SPEED);</span>
<span class="pc bpc" id="L53" title="1 of 2 branches missed.">            if (avgSpeedEnc.isStoreTwoDirections())</span>
<span class="nc bnc" id="L54" title="All 2 branches missed.">                setSpeed(true, edgeId, edgeIntAccess, way.hasTag(&quot;highway&quot;, &quot;steps&quot;) ? MEAN_SPEED - 2 : MEAN_SPEED);</span>
        }
<span class="fc" id="L56">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.13.202504020838</span></div></body></html>